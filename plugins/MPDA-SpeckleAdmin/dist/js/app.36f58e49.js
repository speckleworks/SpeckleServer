(function(e){function t(t){for(var r,a,i=t[0],s=t[1],u=t[2],l=0,d=[];l<i.length;l++)a=i[l],o[a]&&d.push(o[a][0]),o[a]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);f&&f(t);while(d.length)d.shift()();return c.push.apply(c,u||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],r=!0,a=1;a<n.length;a++){var i=n[a];0!==o[i]&&(r=!1)}r&&(c.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},a={app:0},o={app:0},c=[];function i(e){return s.p+"js/"+({}[e]||e)+"."+{"chunk-2d0af48a":"57711a66","chunk-a45fa086":"32159bb9","chunk-6e6c150c":"6427a6d8","chunk-2d0b9d35":"7b85c2f4","chunk-2d0cb6c3":"163e2d4b","chunk-2d0d7de8":"6d5249f8","chunk-2d217357":"8f2a9bef","chunk-2d22d1db":"a18fbe82","chunk-4ab64705":"8f19b6e8","chunk-bea16dec":"4199e3a8","chunk-c45573d2":"a0caa85f","chunk-0083a15b":"aa8585a5","chunk-0a9372bf":"ab5d6fa7","chunk-080abe1e":"c3689356","chunk-2d0abfdc":"e3de337b","chunk-2d0b3630":"dfd5e278","chunk-2d0db2c8":"54e5899a","chunk-298df38e":"fa617d52","chunk-2d2138f6":"d824e297","chunk-43e930b8":"d24540e0","chunk-7abd522e":"ca5e6a11","chunk-2d0d9f44":"1e1b50e4","chunk-35bc4d64":"badf83ce","chunk-a5f28366":"f801b5b2","chunk-f2159fa4":"5ab0aec8","chunk-2d21ed68":"a9718953"}[e]+".js"}function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n={"chunk-4ab64705":1,"chunk-0083a15b":1,"chunk-0a9372bf":1,"chunk-080abe1e":1,"chunk-298df38e":1,"chunk-43e930b8":1,"chunk-7abd522e":1,"chunk-35bc4d64":1,"chunk-a5f28366":1,"chunk-f2159fa4":1};a[e]?t.push(a[e]):0!==a[e]&&n[e]&&t.push(a[e]=new Promise(function(t,n){for(var r="css/"+({}[e]||e)+"."+{"chunk-2d0af48a":"31d6cfe0","chunk-a45fa086":"31d6cfe0","chunk-6e6c150c":"31d6cfe0","chunk-2d0b9d35":"31d6cfe0","chunk-2d0cb6c3":"31d6cfe0","chunk-2d0d7de8":"31d6cfe0","chunk-2d217357":"31d6cfe0","chunk-2d22d1db":"31d6cfe0","chunk-4ab64705":"e0850488","chunk-bea16dec":"31d6cfe0","chunk-c45573d2":"31d6cfe0","chunk-0083a15b":"b2d96ffe","chunk-0a9372bf":"014b52ed","chunk-080abe1e":"c22e1483","chunk-2d0abfdc":"31d6cfe0","chunk-2d0b3630":"31d6cfe0","chunk-2d0db2c8":"31d6cfe0","chunk-298df38e":"3ef275e0","chunk-2d2138f6":"31d6cfe0","chunk-43e930b8":"4e93b041","chunk-7abd522e":"71cede48","chunk-2d0d9f44":"31d6cfe0","chunk-35bc4d64":"d301baa8","chunk-a5f28366":"2380be23","chunk-f2159fa4":"e463e98c","chunk-2d21ed68":"31d6cfe0"}[e]+".css",o=s.p+r,c=document.getElementsByTagName("link"),i=0;i<c.length;i++){var u=c[i],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===r||l===o))return t()}var d=document.getElementsByTagName("style");for(i=0;i<d.length;i++){u=d[i],l=u.getAttribute("data-href");if(l===r||l===o)return t()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=t,f.onerror=function(t){var r=t&&t.target&&t.target.src||o,c=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");c.code="CSS_CHUNK_LOAD_FAILED",c.request=r,delete a[e],f.parentNode.removeChild(f),n(c)},f.href=o;var m=document.getElementsByTagName("head")[0];m.appendChild(f)}).then(function(){a[e]=0}));var r=o[e];if(0!==r)if(r)t.push(r[2]);else{var c=new Promise(function(t,n){r=o[e]=[t,n]});t.push(r[2]=c);var u,l=document.getElementsByTagName("head")[0],d=document.createElement("script");d.charset="utf-8",d.timeout=120,s.nc&&d.setAttribute("nonce",s.nc),d.src=i(e),u=function(t){d.onerror=d.onload=null,clearTimeout(f);var n=o[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src,c=new Error("Loading chunk "+e+" failed.\n("+r+": "+a+")");c.type=r,c.request=a,n[1](c)}o[e]=void 0}};var f=setTimeout(function(){u({type:"timeout",target:d})},12e4);d.onerror=d.onload=u,l.appendChild(d)}return Promise.all(t)},s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=t,u=u.slice();for(var d=0;d<u.length;d++)t(u[d]);var f=l;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("7f7f"),n("ac6a");var r=n("f499"),a=n.n(r),o=(n("a481"),n("28a5"),n("14c6"),n("08c1"),n("4842"),n("d9fc"),n("2b0e")),c=n("bc3a"),i=n.n(c),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",{attrs:{dark:e.$store.state.dark}},[n("v-navigation-drawer",{attrs:{fixed:"",app:"",clipped:"",xxxclass:"elevation-5"},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[n("nav-drawer")],1),n("v-toolbar",{attrs:{fixed:"",app:"","clipped-left":"","clipped-right":"",xxxstyle:"z-index: 100000"}},[n("v-toolbar-side-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),n("v-toolbar-title",{staticClass:"text-uppercase font-weight-light"},[e._v(e._s(e.$route.name))]),n("v-spacer"),n("v-btn",{attrs:{flat:"",fab:"",small:"",color:""},nativeOn:{click:function(t){return e.fullscreen(t)}}},[n("v-icon",[e._v(e._s(e.isFullScreen?"fullscreen_exit":"fullscreen"))])],1),e.$route.path.includes("view")?n("div",{staticClass:"mt-1"},[n("v-btn",{attrs:{fab:"",small:"",color:"primary"},nativeOn:{click:function(t){return e.toggleControlsViewer(t)}}},[n("v-icon",[e._v(e._s(e.$store.state.viewerControls?"close":"3d_rotation"))])],1)],1):e._e()],1),n("v-content",[n("keep-alive",{attrs:{exclude:"StreamDetailView,SigninViewCallback,SigninView"}},[n("router-view")],1)],1)],1)},u=[],l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-list",{attrs:{expand:!0,subheader:"",dense:"","two-line":""}},[n("v-list-group",{attrs:{value:!e.$store.state.isAuth},scopedSlots:e._u([{key:"activator",fn:function(){return[n("v-list-tile",{attrs:{"xxx-v-if":"$store.state.serverManifest.serverName"}},[n("v-list-tile-action",[n("v-icon",[e._v("account_circle")])],1),e.$store.state.server?n("v-list-tile-content",[n("v-list-tile-title",{staticClass:"xxx-font-weight-light caption"},[n("b",[e._v(e._s(e.$store.state.serverManifest.serverName))])])],1):n("v-list-tile-content",[n("v-list-tile-title",{staticClass:"xxx-font-weight-light caption"},[n("b",[e._v("No server selected.")])])],1)],1)]},proxy:!0}])},[e.$store.state.isAuth?n("v-list-tile",[n("v-list-tile-action",[n("v-icon",[e._v("info")])],1),n("v-list-tile-content",[n("v-list-tile-sub-title",[e._v("Server version: "+e._s(e.$store.state.serverManifest.version))]),n("v-list-tile-sub-title",[e._v("App version: "+e._s(e.$store.state.appVersion))])],1)],1):e._e(),e.$store.state.isAuth?n("v-list-tile",{attrs:{to:"/profile"}},[n("v-list-tile-action",[n("v-icon",[e._v("face")])],1),n("v-list-tile-content",[n("v-list-tile-title",[e._v("Profile")])],1)],1):e._e(),e.$store.state.isAuth?n("v-list-tile",{on:{click:function(t){return e.logout()}}},[n("v-list-tile-action",[n("v-icon",{staticClass:"red--text"},[e._v("exit_to_app")])],1),n("v-list-tile-content",[n("v-list-tile-title",[e._v("\n            Logout\n          ")]),n("v-list-tile-sub-title",{staticClass:"xxx-font-weight-lightxxx caption"},[e._v("\n            Logs you out of the current server.\n          ")])],1)],1):n("v-list-tile",{attrs:{to:"/signin"}},[n("v-list-tile-action",[n("v-icon",[e._v("lock")])],1),n("v-list-tile-content",[n("v-list-tile-title",[e._v("Signin")]),n("v-list-tile-sub-title",[e._v("Login or register")])],1)],1)],1)],1),e.$store.state.isAuth?n("v-list",{staticClass:"pa-0",attrs:{"two-line":""}},[n("v-list-tile",{attrs:{to:"/"}},[n("v-list-tile-action",[n("v-icon",[e._v("home")])],1),n("v-list-tile-content",[n("v-list-tile-title",[e._v("Home")]),n("v-list-tile-sub-title",{staticClass:"xxx-font-weight-light caption"},[e._v("Everything at a glance.")])],1)],1),n("v-list-tile",{attrs:{to:"/streams"}},[n("v-list-tile-action",[n("v-icon",[e._v("import_export")])],1),n("v-list-tile-content",[n("v-list-tile-title",[e._v("Streams")]),n("v-list-tile-sub-title",{staticClass:"xxx-font-weight-light caption"},[e._v("Create and manage your streams.")])],1)],1),n("v-list-tile",{attrs:{to:"/projects"}},[n("v-list-tile-action",[n("v-icon",[e._v("business")])],1),n("v-list-tile-content",[n("v-list-tile-title",[e._v("Projects")]),n("v-list-tile-sub-title",{staticClass:"xxx-font-weight-light caption"},[e._v("Group your data and share it with others.")])],1)],1),n("v-list-tile",{attrs:{to:"/trash"}},[n("v-list-tile-action",[n("v-icon",[e._v("delete_outline")])],1),n("v-list-tile-content",[n("v-list-tile-title",[e._v("Archive")]),n("v-list-tile-sub-title",{staticClass:"xxx-font-weight-light caption"},[e._v("The good old recycle bin.")])],1)],1),n("v-list-tile",{attrs:{to:"/view"}},[n("v-list-tile-action",[n("v-icon",[e._v("360")])],1),n("v-list-tile-content",[n("v-list-tile-title",[e._v("Viewer")]),n("v-list-tile-sub-title",{staticClass:"xxx-font-weight-light caption"},[e._v("3d speckle stream viewer")])],1)],1),n("v-list-tile",{attrs:{to:"/processors"}},[n("v-list-tile-action",[n("v-icon",[e._v("code")])],1),n("v-list-tile-content",[n("v-list-tile-title",[e._v("Processor")]),n("v-list-tile-sub-title",{staticClass:"xxx-font-weight-light caption"},[e._v("Stream processing")])],1)],1),e._l(e.$store.state.adminPlugins,function(t){return n("v-list-tile",{key:t.route,attrs:{to:t.route}},[n("v-list-tile-action",[n("v-icon",[e._v(e._s(t.icon))])],1),n("v-list-tile-content",[n("v-list-tile-title",[e._v(e._s(t.name))]),n("v-list-tile-sub-title",{staticClass:"xxx-font-weight-light caption"},[e._v(e._s(t.description))])],1)],1)}),n("v-divider",{staticClass:"ma-3"}),"admin"===e.$store.state.user.role?n("v-list-tile",{attrs:{to:"/admin"}},[n("v-list-tile-action",[n("v-icon",[e._v("settings")])],1),n("v-list-tile-content",[n("v-list-tile-title",[e._v("Admin")]),n("v-list-tile-sub-title",{staticClass:"xxx-font-weight-light caption"},[e._v("Server administration")])],1)],1):e._e(),n("v-list-tile",{attrs:{to:"/pluginsadmin"}},[n("v-list-tile-action",[n("v-icon",[e._v("extensions")])],1),n("v-list-tile-content",[n("v-list-tile-title",[e._v("Plugins")]),n("v-list-tile-sub-title",{staticClass:"xxx-font-weight-light caption"},[e._v("Plugins registered on this server")])],1)],1),n("v-divider",{staticClass:"ma-3"})],2):e._e(),n("v-list",{attrs:{"xxxv-if":"$store.state.isAuth","two-line":"",subheader:""}},[n("v-list-tile",{attrs:{href:"https://speckle.systems/docs/web/management",target:"_blank"}},[n("v-list-tile-action",[n("v-icon",[e._v("help")])],1),n("v-list-tile-content",[n("v-list-tile-title",[e._v("App Help")]),n("v-list-tile-sub-title",{staticClass:"caption"},[e._v("Help for this web app.")])],1)],1),n("v-list-tile",{attrs:{href:"https://speckle.systems/docs/essentials/start",target:"_blank"}},[n("v-list-tile-action",[n("v-icon",[e._v("help_outline")])],1),n("v-list-tile-content",[n("v-list-tile-title",[e._v("Speckle Help")]),n("v-list-tile-sub-title",{staticClass:"caption"},[e._v("How to get started with Speckle.")])],1)],1)],1),e.$store.state.isAuth?n("v-divider",{attrs:{xxxsclass:"mb-4"}}):e._e(),n("v-list",{staticClass:"ma-0 pa-0",attrs:{dense:"",subheader:""}},[n("v-list-tile",{on:{click:function(t){return e.toggleDark()}}},[n("v-list-tile-action",[n("v-icon",[e._v(e._s(e.$store.state.dark?"wb_sunny":"nights_stay"))])],1),n("v-list-tile-content",[n("v-list-tile-title",[e._v(e._s(e.$store.state.dark?"Day Mode":"Dark Mode"))])],1)],1)],1),n("v-divider",{staticClass:"ma-0 pa-0"}),n("v-card",{staticClass:"elevation-0"},[n("v-card-text",[n("div",{staticClass:"text-uppercase text-xs-center-xxx caption ml-0 pa-5 ml-2 mt-3 mb-3"},[e._v("\n        Brought to you by:"),n("br"),n("a",{staticStyle:{xxxcolor:"white","text-decoration":"none"},attrs:{href:"https://speckle.works",target:"_blank"}},[n("b",[e._v("Speckle")]),e._v(",\n          "),n("span",{staticClass:" caption"},[e._v("the open source data platform for AEC.")])])])])],1)],1)},d=[],f={name:"SiteNavigation",data:function(e){return{dark:!1}},methods:{logout:function(){this.$store.dispatch("logout"),this.$router.push("/signin")},toggleDark:function(){this.dark=!this.dark,localStorage.setItem("dark",this.dark),this.$store.commit("SET_DARK",this.dark)}},mounted:function(){this.dark=this.$store.state.dark}},m=f,h=n("2877"),p=Object(h["a"])(m,l,d,!1,null,null,null),v=p.exports,g={name:"MainApp",components:{NavDrawer:v},data:function(e){return{drawer:!0,dark:!1,viewerControls:!0,isFullScreen:!1}},methods:{toggleDark:function(){this.dark=!this.dark,localStorage.setItem("dark",this.dark)},logout:function(){this.$store.dispatch("logout"),this.$router.push("/signin")},toggleControlsViewer:function(){this.$store.commit("TOGGLE_VIEWER_CONTROLS")},fullscreen:function(){if(document.fullscreenElement)return document.exitFullscreen(),void(this.isFullScreen=!1);var e=document.documentElement;this.isFullScreen=!0,e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}},created:function(){this.$store.state.isAuth&&(this.$store.dispatch("getStreams","omit=objects,layers&isComputedResult=false&sort=updatedAt"),this.$store.dispatch("getProjects"),this.$store.dispatch("getProcessors"),this.$store.dispatch("createClient")),"true"===localStorage.getItem("dark")&&(this.dark=!0,this.$store.commit("SET_DARK",!0)),this.$store.dispatch("loadLambdas")},updated:function(){}},b=g,_=(n("5c0b"),Object(h["a"])(b,s,u,!1,null,null,null)),E=_.exports,S=n("fb4d"),w=n.n(S),k=n("8c4f"),A=(n("96cf"),n("3b8d")),T=(n("5df3"),n("795b")),j=n.n(T),I=n("a4bb"),y=n.n(I),D=(n("7514"),n("20d6"),n("5d73")),O=n.n(D),R=n("75fc"),x=(n("55dd"),n("b6d0")),P=n.n(x),C=(n("6762"),n("2fdb"),n("6b54"),n("2f62")),L=(n("6233"),n("c36e")),U=n.n(L),M=n("c64e"),N=n.n(M),$=n("1149"),q=n.n($);function J(){this.Lambdas=["receiver","filter","sender","restAPI","downloadobjects","uploadobjects","arupCompute","proximity"]}var F=n("7618"),W=n("a745"),B=n.n(W),V=function e(t){var n={};for(var r in t)t.hasOwnProperty(r)&&(B()(t[r])||("object"===Object(F["a"])(t[r])&&null!==t[r]?n[r]=e(t[r]):n[r]=t[r]));return n},G=function e(t){var n={};for(var r in t)t.hasOwnProperty(r)&&(B()(t[r])?n[r]="Array with ".concat(t[r].length," elements"):"object"===Object(F["a"])(t[r])&&null!==t[r]&&(n[r]=e(t[r])));return n},K=function(){var e=Object(A["a"])(regeneratorRuntime.mark(function e(t){var n,r,a,o,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=t.clientId,r=t.authority,a=t.loginRequest,o=new Msal.UserAgentApplication({auth:{clientId:n,authority:r,redirectUri:window.location.origin+"/msal.html"},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}}),e.next=4,o.getCachedToken(n);case 4:if(c=e.sent,!c){e.next=7;break}return e.abrupt("return",c.accessToken);case 7:return e.prev=7,e.next=10,o.acquireTokenSilent(a);case 10:c=e.sent,e.next=32;break;case 13:if(e.prev=13,e.t0=e["catch"](7),console.log("MSAL Error: "+e.t0.errorCode),"user_login_error"!==e.t0.errorCode){e.next=26;break}return window.localStorage.msalClientId=n,e.next=20,o.loginPopup(a);case 20:return delete window.localStorage.msalClientId,e.next=23,K({clientId:n,authority:r,loginRequest:a});case 23:return e.abrupt("return",e.sent);case 26:if("token_renewal_error"!==e.t0.errorCode){e.next=32;break}return window.localStorage.msalClientId=n,e.next=30,o.acquireTokenPopup(a);case 30:c=e.sent,delete window.localStorage.msalClientId;case 32:return e.abrupt("return",c.accessToken);case 33:case"end":return e.stop()}},e,null,[[7,13]])}));return function(t){return e.apply(this,arguments)}}(),H={state:{streams:[],users:[],projects:[]},mutations:{ADD_STREAMS_ADMIN:function(e,t){t.forEach(function(t){-1===e.streams.findIndex(function(e){return e.streamId===t.streamId})&&(t.description||(t.description="..."),t.tags||(t.tags=[]),e.streams.unshift(t))})},UPDATE_STREAM:function(e,t){var n=e.streams.find(function(e){return e.streamId===t.streamId});if(!n)return console.error("User not found; aborting update.");y()(t).forEach(function(e){n[e]=t[e]}),n.updatedAt=(new Date).toISOString()},DELETE_STREAM:function(e,t){var n=e.streams.findIndex(function(e){return e.streamId===t.streamId});n>-1?e.streams.splice(n,1):console.log("Failed to remove stream ".concat(t.streamId," from store."))},ADD_USERS_ADMIN:function(e,t){t.forEach(function(t){var n=e.users.find(function(e){return e._id===t._id});n?n=t:e.users.unshift(t)})},UPDATE_USER:function(e,t){var n=null;if(n=e.users.find(function(e){return e._id===t._id}),!n)return console.error("User not found; aborting update.");y()(t).forEach(function(e){n[e]=t[e]})},ADD_PROJECTS_ADMIN:function(e,t){t.forEach(function(t){-1===e.projects.findIndex(function(e){return e._id===t._id})&&(t.tags||(t.tags=[]),t.deleted||(t.deleted=!1),e.projects.unshift(t))})},UPDATE_PROJECT:function(e,t){var n=e.projects.find(function(e){return e._id===t._id});null!=n&&(y()(t).forEach(function(e){n[e]=t[e]}),n.updatedAt=(new Date).toISOString())},DELETE_PROJECT:function(e,t){var n=e.projects.findIndex(function(e){return e._id===t._id});n>-1?e.projects.splice(n,1):console.log("Failed to remove project ".concat(t._id," from store."))}},getters:{},actions:{getStreamsAdmin:function(e){return new j.a(function(t,n){i.a.get("streams/admin").then(function(n){return e.commit("ADD_STREAMS_ADMIN",n.data.resources),t(n.data.resources)}).catch(function(e){return console.log(e),n(e)})})},getUsersAdmin:function(e){return new j.a(function(t,n){i.a.get("accounts/admin").then(function(n){return e.commit("ADD_USERS_ADMIN",n.data.resource),t(n.data.resources)}).catch(function(e){return console.log(e),n(e)})})},updateUserAdmin:function(e,t){return new j.a(function(n,r){i.a.put("accounts/"+t._id,t).then(function(r){return n(e.commit("UPDATE_USER",t))}).catch(function(e){return r(e)})})},getProjectsAdmin:function(e){return new j.a(function(t,n){i.a.get("projects/admin").then(function(n){return e.commit("ADD_PROJECTS_ADMIN",n.data.resources),t(n.data.resources)}).catch(function(e){return console.log(e),n(e)})})}}},z=H,Y={state:{showEdges:!1,edgesThreshold:45,castShadows:!1,meshOverrides:{opacity:84,specular:30}},mutations:{TOGGLE_EDGES:function(e,t){e.showEdges=t,localStorage.setItem("viewerSettings",a()(e))},SET_EDGES_THRESHOLD:function(e,t){e.edgesThreshold=t,localStorage.setItem("viewerSettings",a()(e))},TOGGLE_SHADOWS:function(e,t){e.castShadows=t,localStorage.setItem("viewerSettings",a()(e))},SET_MESH_OPACITY:function(e,t){e.meshOverrides.opacity=t,localStorage.setItem("viewerSettings",a()(e))},SET_MESH_SPECULAR:function(e,t){e.meshOverrides.specular=t,localStorage.setItem("viewerSettings",a()(e))},SET_ALL_VIEWER_SETTINGS:function(e,t){y()(t).forEach(function(n){e[n]=t[n]})}}},Q=Y;o["default"].use(C["a"]);var Z=new C["a"].Store({state:{appVersion:"1.0.3",server:null,serverManifest:null,token:null,user:{},isAuth:!1,streams:[],deStreams:[],clients:[],projects:[],comments:[],users:[],loadedStreamIds:[],objects:[],legend:null,selectedObjects:[],myClient:null,dark:!1,viewerControls:!1,plugins:[],adminPlugins:[],lambdas:[],processors:[],tokens:{}},getters:{streamClients:function(e){return function(t){return e.clients.filter(function(e){return e.streamId===t})}},filteredResources:function(e){return function(t,n){n||(n="streams");var r=[];return"streams"===n&&(r=e.streams.filter(function(e){return null==e.parent&&!1===e.deleted})),"projects"===n&&(r=e.projects.filter(function(e){return!1===e.deleted})),t&&0!==t.length?(t.forEach(function(t){if(t.key=t.key.toLowerCase(),null===t.value)r=r;else switch(r=r.filter(function(e){return""!==e.name}),t.key){case"private":r=t.value?r.filter(function(e){return e.private.toString()===t.value}):r.filter(function(e){return!0===e.private});break;case"public":r=t.value?r.filter(function(e){return(!e.private).toString()===t.value}):r.filter(function(e){return!1===e.private});break;case"tag":case"tags":var n=t.value.trim().split(",").map(function(e){return e.toLowerCase().trim()});console.log(n),r=r.filter(function(e){var t=e.tags.map(function(e){return e.toLowerCase()});return n.every(function(e){return t.includes(e)})});break;case"jn":r=r.filter(function(e){return e.jobNumber===t.value.trim()});break;case"owner":"me"===t.value.toLowerCase().trim()&&(r=r.filter(function(t){return t.owner===e.user._id}));break;case"mine":r=r.filter(function(t){return t.owner===e.user._id});break;case"shared":r=r.filter(function(t){return t.owner!==e.user._id});break;case"name":r=r.filter(function(e){return!e.name||e.name.toLowerCase().includes(t.value.toLowerCase())});break;case"streamid":case"id":r=r.filter(function(e){return e.streamId.toLowerCase().includes(t.value.toLowerCase())});break}}),r):r}},objectPropertyKeys:function(e){var t=new P.a,n=new P.a;e.objects.forEach(function(e){if(e.properties){var r=q()(V(e.properties));for(var a in r)"hash"===a||"id"===a||a.toLowerCase().includes("hash")||a.toLowerCase().includes("_carbon")||a.includes("__")||(t.add(a),"string"===typeof r[a]&&n.add(a))}});var r={allKeys:Object(R["a"])(t).sort(function(e,t){return e.split(".").length-t.split(".").length}).sort(function(e,t){return e.length-t.length}),stringKeys:Object(R["a"])(n).sort(function(e,t){return e.split(".").length-t.split(".").length}).sort(function(e,t){return e.length-t.length})};return r},hasStructuralProperties:function(e){var t=!0,n=!1,r=void 0;try{for(var a,o=O()(e.objects);!(t=(a=o.next()).done);t=!0){var c=a.value;try{if(null!==c.properties.structural.result)return!0}catch(i){}}}catch(s){n=!0,r=s}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return!1},structuralKeys:function(e){var t=new P.a,n=!0,r=!1,a=void 0;try{for(var o,c=O()(e.objects);!(n=(o=c.next()).done);n=!0){var i=o.value;try{var s=q()(G(i.properties.structural.result));for(var u in s)t.add(u)}catch(l){}}}catch(d){r=!0,a=d}finally{try{n||null==c.return||c.return()}finally{if(r)throw a}}return Object(R["a"])(t)},allTags:function(e){var t=new P.a;return e.streams.forEach(function(e){e.deleted||e.tags.forEach(function(e){return t.add(e)})}),e.projects.forEach(function(e){e.tags.forEach(function(e){return t.add(e)})}),Object(R["a"])(t)},allStreamTags:function(e){var t=new P.a;return e.streams.forEach(function(e){e.deleted||e.tags.forEach(function(e){return t.add(e)})}),Object(R["a"])(t)},allProjectTags:function(e){var t=new P.a;return e.projects.forEach(function(e){e.tags.forEach(function(e){return t.add(e)})}),Object(R["a"])(t)},allJobNumbers:function(e){var t=new P.a;return e.streams.forEach(function(e){return t.add(e.jobNumber)}),e.projects.forEach(function(e){return t.add(e.jobNumber)}),Object(R["a"])(t)},allJobNumbersStreams:function(e){var t=new P.a;return e.streams.forEach(function(e){return t.add(e.jobNumber)}),Object(R["a"])(t)},allJobNumbersProjects:function(e){var t=new P.a;return e.projects.forEach(function(e){return t.add(e.jobNumber)}),Object(R["a"])(t)}},mutations:{SET_DARK:function(e,t){e.dark=t},TOGGLE_VIEWER_CONTROLS:function(e){e.viewerControls=!e.viewerControls},SET_VIEWER_CONTROLS:function(e,t){e.viewerControls=t},ADD_STREAMS:function(e,t){t.forEach(function(t){-1===e.streams.findIndex(function(e){return e.streamId===t.streamId})&&(t.description||(t.description="..."),t.tags||(t.tags=[]),t.jobNumber||(t.jobNumber=""),e.streams.unshift(t))})},UPDATE_STREAM:function(e,t){var n=e.streams.find(function(e){return e.streamId===t.streamId});if(!n)return console.error("stream not found; aborting update.");y()(t).forEach(function(e){n[e]=t[e]}),n.updatedAt=(new Date).toISOString()},UPDATE_STREAM_DATA:function(e,t){var n=e.streams.find(function(e){return e.streamId===t.streamId});t.layers&&(n.layers=t.layers),n.updatedAt=(new Date).toISOString()},DELETE_STREAM:function(e,t){var n=e.streams.findIndex(function(e){return e.streamId===t.streamId});n>-1?e.streams.splice(n,1):console.log("Failed to remove stream ".concat(t.streamId," from store."))},ADD_CLIENTS:function(e,t){t.forEach(function(t){-1===e.clients.findIndex(function(e){return e._id===t._id})&&e.clients.push(t)})},ADD_DE_STREAM:function(e,t){var n=e.deStreams.find(function(e){return e.streamId===t});n?(n.layers=t.layers,n.objects=t.objects):e.deStreams.push(t)},ADD_DE_STREAM_LAYER:function(e,t){console.log(t);var n=e.deStreams.find(function(e){return e.streamId===t.streamId}),r={name:"Param group ".concat(n.layers.length+1),orderIndex:n.layers.length,startIndex:n.objects.length,objectCount:0,topology:"0-0",guid:N()()};n.layers.push(r)},UPDATE_DE_STREAM_LAYER:function(e,t){var n=t.streamId,r=t.layer,a=t.objects,o=e.deStreams.find(function(e){return e.streamId===n}),c=!1,i=0;o.layers.forEach(function(e){if(c)e.startIndex+=i;else if(e.guid===r.guid){var t;e.name=r.name,e.topology="0-".concat(a.length),i=a.length-e.objectCount,(t=o.objects).splice.apply(t,[e.startIndex,e.objectCount].concat(Object(R["a"])(a))),e.objectCount=a.length,c=!0}})},REMOVE_DE_STREAM_LAYER:function(e,t){var n=t.streamId,r=t.layer,a=e.deStreams.find(function(e){return e.streamId===n});a.objects.splice(r.startIndex,r.objectCount);var o=!1;a.layers.forEach(function(e){o?(e.startIndex-=r.objectCount,e.orderIndex-=1):e.guid===r.guid&&(o=!0)}),a.layers=a.layers.filter(function(e){return e.guid!==r.guid})},APPEND_DE_STREAM_LAYERS_FROM_CSV:function(e,t){var n=t.streamId,r=t.transposed,a=e.deStreams.find(function(e){return e.streamId===n}),o=!0,c=!1,i=void 0;try{for(var s,u=O()(r);!(o=(s=u.next()).done);o=!0){var l,d=s.value,f={name:""!==d[0]?d[0]:"Unnamed",orderIndex:-1,startIndex:a.objects.length,objectCount:d.length-1,topology:"0-".concat(d.length-1),guid:N()()};a.layers.push(f);var m=d.slice(1,d.length);console.log(m),(l=a.objects).push.apply(l,Object(R["a"])(m.map(function(e){return e?"boolean"===typeof e?{type:"Boolean",value:e}:"number"===typeof e?{type:"Number",value:e}:"string"===typeof e?{type:"String",value:e}:void 0:{type:"Null",value:""}}))),0}}catch(h){c=!0,i=h}finally{try{o||null==u.return||u.return()}finally{if(c)throw i}}a.layers.forEach(function(e,t){console.log(t),e.orderIndex=t})},ADD_PROJECTS:function(e,t){t.forEach(function(t){-1===e.projects.findIndex(function(e){return e._id===t._id})&&(t.tags||(t.tags=[]),t.deleted||(t.deleted=!1),t.jobNumber||(t.jobNumber=""),e.projects.unshift(t))})},UPDATE_PROJECT:function(e,t){var n=e.projects.find(function(e){return e._id===t._id});if(null==n)return console.warn("The admin user is not on this project");y()(t).forEach(function(e){n[e]=t[e]}),n.updatedAt=(new Date).toISOString()},DELETE_PROJECT:function(e,t){var n=e.projects.findIndex(function(e){return e._id===t._id});n>-1?e.projects.splice(n,1):console.log("Failed to remove project ".concat(t._id," from store."))},ADD_LAMBDAS:function(e,t){t.forEach(function(t){-1===e.lambdas.findIndex(function(e){return e.function===t.function})&&e.lambdas.push(t)})},ADD_PROCESSORS:function(e,t){t.forEach(function(t){-1===e.processors.findIndex(function(e){return e._id===t._id})&&(t.tags||(t.tags=[]),e.processors.unshift(t))})},UPDATE_PROCESSOR:function(e,t){var n=e.processors.find(function(e){return e._id==t._id});y()(t).forEach(function(e){n[e]=t[e]})},DELETE_PROCESSOR:function(e,t){var n=e.processors.findIndex(function(e){return e._id===t._id});n>-1?e.processors.splice(n,1):console.log("Failed to remove processor ".concat(t._id," from store."))},ADD_TOKEN:function(e,t){var n=t.id,r=t.token;o["default"].set(e.tokens,n,r),console.log(e.tokens)},DELETE_TOKEN:function(e,t){o["default"].delete(e.tokens,t),console.log(e.tokens)},ADD_USER:function(e,t){var n=e.users.find(function(e){return e._id===t._id});n?n=t:e.users.unshift(t)},ADD_USERS:function(e,t){t.forEach(function(t){var n=e.users.find(function(e){return e._id===t._id});n?n=t:e.users.unshift(t)})},UPDATE_USER:function(e,t){var n=null;if(n=t._id===e.user._id?e.user:e.users.find(function(e){return e._id===t._id}),!n)return console.error("User not found; aborting update.");y()(t).forEach(function(e){n[e]=t[e]})},SET_SERVER:function(e,t){e.server=t},SET_SERVER_DETAILS:function(e,t){e.serverManifest=t},SET_TOKEN:function(e,t){e.token=t,e.isAuth=!0},SET_USER:function(e,t){e.user=t},SET_WEB_APP_CLIENT:function(e,t){e.client=t},FLUSH_ALL:function(e){e.token=null,e.user={},e.streams=[],e.projects=[],e.clients=[],e.users=[],e.comments=[],e.isAuth=!1,e.server=null},ADD_LOADED_STREAMID:function(e,t){e.loadedStreamIds=Object(R["a"])(new P.a([].concat(Object(R["a"])(e.loadedStreamIds),[t])))},REMOVE_LOADED_STREAMID:function(e,t){var n=e.loadedStreamIds.indexOf(t);-1!==n?e.loadedStreamIds.splice(n,1):console.warn("Failed to remove loaded streamid: ".concat(t," from ").concat(e.loadedStreamIds))},ADD_OBJECTS:function(e,t){var n;(n=e.objects).push.apply(n,Object(R["a"])(t))},UPDATE_OBJECTS_STREAMS:function(e,t){var n=t.objIds,r=t.streamToAdd,a=t.streamToRemove;n.forEach(function(t){var n=e.objects.find(function(e){return e._id===t});if(n&&(r&&-1===n.streams.indexOf(r)&&n.streams.push(r),a)){var o=n.streams.indexOf(a);-1!==o&&n.streams.splice(o,1)}})},REMOVE_OBJECTS:function(e,t){e.objects=e.objects.filter(function(e){return-1===t.indexOf(e._id)})},SET_SELECTED_OBJECTS:function(e,t){var n=t.objectIds;n.length>0?e.selectedObjects=Object(R["a"])(new P.a([].concat(Object(R["a"])(e.selectedObjects),Object(R["a"])(n)))):e.selectedObjects=[]},ADD_SELECTED_OBJECTS:function(e,t){var n=t.objectIds;e.selectedObjects=Object(R["a"])(new P.a([].concat(Object(R["a"])(e.selectedObjects),Object(R["a"])(n))))},REMOVE_SELECTED_OBJECTS:function(e,t){var n=t.objectIds;n.forEach(function(t){var n=e.selectedObjects.indexOf(t);-1!==n&&e.selectedObjects.splice(n,1)})},SET_LEGEND:function(e,t){e.legend=t},ADD_PLUGIN:function(e,t){e.plugins.push(t)}},actions:{getStream:function(e,t){return new j.a(function(n,r){var a=e.state.streams.find(function(e){return e.streamId===t.streamId});if(a)return n(a);i.a.get("streams/".concat(t.streamId,"?omit=objects")).then(function(t){return e.commit("ADD_STREAMS",[t.data.resource]),n(t)}).catch(function(e){return r(e)})})},refreshStream:function(e,t){return new j.a(function(n,r){i.a.get("streams/".concat(t.streamId,"?omit=objects")).then(function(t){return e.commit("UPDATE_STREAM",t.data.resource),n(t)}).catch(function(e){return r(e)})})},getStreams:function(e,t){return new j.a(function(n,r){i.a.get("streams?".concat(t||"")).then(function(t){return e.commit("ADD_STREAMS",t.data.resources),n(t.data.resources)}).catch(function(e){return console.log(e),r(e)})})},createStream:function(e,t){return new j.a(function(n,r){i.a.post("streams").then(function(n){return console.log(n),t.streamId=n.data.resource.streamId,n.data.resource.onlineEditable=!0,e.commit("ADD_STREAMS",[n.data.resource]),e.commit("ADD_STREAMS_ADMIN",[n.data.resource]),i.a.put("streams/".concat(n.data.resource.streamId),t)}).then(function(r){return console.log(r),e.commit("UPDATE_STREAM",t),n(t)}).catch(function(e){return console.error(e),r(e)})})},updateStream:function(e,t){i.a.put("streams/".concat(t.streamId),t).then(function(n){e.commit("UPDATE_STREAM",t)}).catch(function(e){console.warn(e)})},updateStreamObjectsAndLayers:function(e,t){var n=t.streamId,r=t.commitMessage;return new j.a(function(t,a){var o=e.state.deStreams.find(function(e){return e.streamId===n});if(!o)return a(new Error("Stream not found in store."));o.commitMessage=r+" (changed by ".concat(e.state.user.name," ").concat(e.state.user.surname,")"),o.lastChangedBy=e.state.user._id,e.commit("UPDATE_STREAM",{streamId:n,commitMessage:r}),i.a.post("streams/".concat(n,"/clone")).then(function(t){var r=e.state.streams.find(function(e){return e.streamId===n});return e.commit("UPDATE_STREAM",{streamId:n,children:[].concat(Object(R["a"])(r.children),[t.data.clone.streamId])}),i.a.put("streams/".concat(n),o)}).then(function(e){return t(e)}).catch(function(e){return a(e)})})},getStreamClients:function(e,t){i.a.get("streams/".concat(t.streamId,"/clients")).then(function(t){e.commit("ADD_CLIENTS",t.data.resources)}).catch(function(e){console.log(e)})},deleteStream:function(e,t){i.a.delete("streams/".concat(t.streamId)).then(function(n){e.commit("DELETE_STREAM",{streamId:t.streamId})}).catch(function(e){console.log(e)})},getStreamObjects:function(e,t){e.state.streams.find(function(e){return e.streamId===t});return new j.a(function(n,r){e.dispatch("getStream",{streamId:t}).then(function(){return i.a.get("streams/".concat(t,"?fields=objects,layers"))}).then(function(r){var a=r.data.resource.objects.map(function(e){return e._id});e.commit("UPDATE_STREAM",{streamId:t,objects:a,layers:r.data.resource.layers}),n(a)}).catch(function(e){r(e)})})},getObjects:function(e,t){return new j.a(function(e,n){i.a.post("objects/getbulk?omit=base64,rawData,canRead,canWrite,children,anonymousComments,name",t).then(function(t){e(t.data.resources)}).catch(function(e){return n(e)})})},createObjects:function(e,t){return new j.a(function(e,n){i.a.post("objects",t).then(function(t){return e(t.data.resources)}).catch(function(e){return n(e)})})},getProject:function(e,t){return new j.a(function(n,r){i.a.get("projects/".concat(t._id)).then(function(t){return e.commit("ADD_PROJECTS",[t.data.resource]),n(t)}).catch(function(e){return console.error(e),r(e)})})},getProjects:function(e,t){return new j.a(function(n,r){i.a.get("projects?".concat(t||"")).then(function(t){return e.commit("ADD_PROJECTS",t.data.resources),n(t.data.resources)}).catch(function(e){return console.log(e),r(e)})})},createProject:function(e,t){return new j.a(function(n,r){i.a.post("projects",t||{name:"A new speckle project"}).then(function(t){return e.commit("ADD_PROJECTS",[t.data.resource]),e.commit("ADD_PROJECTS_ADMIN",[t.data.resource]),n(t.data.resource)}).catch(function(e){return console.log(e),r(e)})})},updateProject:function(e,t){i.a.put("projects/".concat(t._id),t).then(function(n){e.commit("UPDATE_PROJECT",t)}).catch(function(e){console.warn(e)})},addUserToProject:function(e,t){var n=t.projectId,r=t.userId;return new j.a(function(t,a){var o=e.state.projects.find(function(e){return e._id===n});if(!o)return a(new Error("Failed to find project in state."));i.a.put("projects/".concat(n,"/adduser/").concat(r)).then(function(a){var c={canWrite:Object(R["a"])(new P.a([].concat(Object(R["a"])(o.permissions.canWrite),[r]))),canRead:o.permissions.canRead},i=Object(R["a"])(new P.a([].concat(Object(R["a"])(o.canRead),[r])));return e.commit("UPDATE_PROJECT",{_id:n,permissions:c,canRead:i}),o.streams.forEach(function(t){var n=e.state.streams.find(function(e){return e.streamId===t});e.commit("UPDATE_STREAM",{streamId:t,canWrite:U()([].concat(Object(R["a"])(n.canWrite),[r]))})}),t()}).catch(function(e){return console.warn(e),a(e)})})},upgradeUserInProject:function(e,t){var n=t.projectId,r=t.userId;return new j.a(function(t,a){var o=e.state.projects.find(function(e){return e._id===n});if(!o)return a(new Error("Failed to find project in state."));i.a.put("projects/".concat(n,"/upgradeuser/").concat(r)).then(function(e){return i.a.get("projects/".concat(n,"?fields=permissions"))}).then(function(a){return e.commit("UPDATE_PROJECT",{_id:n,permissions:{canRead:a.data.resource.permissions.canRead,canWrite:a.data.resource.permissions.canWrite}}),o.streams.forEach(function(t){var n=e.state.streams.find(function(e){return e.streamId===t});e.commit("UPDATE_STREAM",{streamId:t,canWrite:U()([].concat(Object(R["a"])(n.canWrite),[r])),canRead:U()([].concat(Object(R["a"])(n.canRead),[r]))})}),t()}).catch(function(e){return console.warn(e),a(e)})})},downgradeUserInProject:function(e,t){var n=t.projectId,r=t.userId;return new j.a(function(t,a){var o=e.state.projects.find(function(e){return e._id===n});if(!o)return a(new Error("Failed to find project in state."));i.a.put("projects/".concat(n,"/downgradeuser/").concat(r)).then(function(a){return e.commit("UPDATE_PROJECT",{_id:n,permissions:a.data.project.permissions}),a.data.streamsToAddReadAndPullWrite.forEach(function(t){var n=e.state.streams.find(function(e){return e.streamId===t});e.commit("UPDATE_STREAM",{streamId:t,canWrite:n.canWrite.filter(function(e){return e!==r}),canRead:U()([].concat(Object(R["a"])(n.canRead),[r]))})}),a.data.streamsToAddToRead.forEach(function(t){var n=e.state.streams.find(function(e){return e.streamId===t});e.commit("UPDATE_STREAM",{streamId:t,canRead:U()([].concat(Object(R["a"])(n.canRead),[r]))})}),t()}).catch(function(e){return console.warn(e),a(e)})})},removeUserInProject:function(e,t){var n=t.projectId,r=t.userId;return new j.a(function(t,a){var o=e.state.projects.find(function(e){return e._id===n});if(!o)return a(new Error("Failed to find project in state."));i.a.delete("projects/".concat(n,"/removeuser/").concat(r)).then(function(a){return e.commit("UPDATE_PROJECT",{_id:n,canRead:a.data.project.canRead,canWrite:a.data.project.canWrite,permissions:a.data.project.permissions}),a.data.streamsToPullBothFrom.forEach(function(t){var n=e.state.streams.find(function(e){return e.streamId===t});e.commit("UPDATE_STREAM",{streamId:t,canRead:n.canRead.filter(function(e){return e!==r}),canWrite:n.canWrite.filter(function(e){return e!==r})})}),a.data.streamsToPullWriteFrom.forEach(function(t){var n=e.state.streams.find(function(e){return e.streamId===t});e.commit("UPDATE_STREAM",{streamId:t,canWrite:n.canWrite.filter(function(e){return e!==r})})}),a.data.streamsToPullReadFrom.forEach(function(t){var n=e.state.streams.find(function(e){return e.streamId===t});e.commit("UPDATE_STREAM",{streamId:t,canRead:n.canRead.filter(function(e){return e!==r})})}),t()}).catch(function(e){return console.warn(e),a(e)})})},addStreamToProject:function(e,t){var n=t.projectId,r=t.streamId;return new j.a(function(t,a){var o=e.state.projects.find(function(e){return e._id===n});if(!o)return a(new Error("Failed to find project in state."));i.a.put("projects/".concat(n,"/addstream/").concat(r)).then(function(a){return e.commit("UPDATE_PROJECT",{_id:n,streams:a.data.project.streams}),e.commit("UPDATE_STREAM",{streamId:r,canRead:a.data.stream.canRead,canWrite:a.data.stream.canWrite}),t()}).catch(function(e){return console.warn(e),a(e)})})},removeStreamFromProject:function(e,t){var n=t.projectId,r=t.streamId;return new j.a(function(t,a){var o=e.state.projects.find(function(e){return e._id===n});if(!o)return a(new Error("Failed to find project in state."));i.a.delete("projects/".concat(n,"/removestream/").concat(r)).then(function(a){return e.commit("UPDATE_PROJECT",{_id:n,streams:a.data.project.streams}),e.commit("UPDATE_STREAM",{streamId:r,canRead:a.data.stream.canRead,canWrite:a.data.stream.canWrite}),t()}).catch(function(e){return console.warn(e),a(e)})})},deleteProject:function(e,t){return new j.a(function(n,r){i.a.delete("projects/".concat(t._id)).then(function(r){e.commit("DELETE_PROJECT",{_id:t._id});var a=!0,o=!1,c=void 0;try{for(var i,s=O()(r.data.modifiedStreams);!(a=(i=s.next()).done);a=!0){var u=i.value;e.commit("UPDATE_STREAM",{streamId:u.streamId,canRead:u.canRead,canWrite:u.canWrite})}}catch(l){o=!0,c=l}finally{try{a||null==s.return||s.return()}finally{if(o)throw c}}return n()}).catch(function(e){return console.warn(e),r(e)})})},loadLambdas:function(e){return new j.a(function(t,n){for(var r=[],a=(new J).Lambdas,o=function(e){r.push(i()({method:"GET",url:".netlify/functions/".concat(a[e]),baseURL:location.protocol+"//"+location.host}).catch(function(t){return console.log("Failed to load lambda: ".concat(a[e]))}))},c=0;c<a.length;c++)o(c);j.a.all(r).then(function(n){var r=[];return n.forEach(function(e){if(e){var t=e.data;t.function=e.request.responseURL.split("/").slice(-1).pop(),r.push(t)}}),e.commit("ADD_LAMBDAS",r),t(r)})})},getProcessor:function(e,t){var n=JSON.parse(window.localStorage.getItem("processor_"+t._id));return null!==n&&e.commit("ADD_PROCESSORS",[n]),n},getProcessors:function(e){var t=JSON.parse(window.localStorage.getItem("processorIds"));if(null===t)return null;var n=[];return t.forEach(function(e){var t=JSON.parse(window.localStorage.getItem("processor_"+e));null!=t&&n.unshift(t)}),e.commit("ADD_PROCESSORS",n),n},createProcessor:function(e,t){var n=N()(),r=t||{name:"A new speckle processor"};r._id=n,r.hasOwnProperty("description")||(r.description="This is a simple speckle processor."),r.hasOwnProperty("tags")||(r.tags=[]),r.hasOwnProperty("blocks")||(r.blocks=[]),r.hasOwnProperty("params")||(r.params=[]),r.owner=e.state.user._id,r.private=!1,r.canRead=[e.state.user._id],r.canWrite=[e.state.user._id],r.anonymousComments=!1,r.comments=[],window.localStorage.setItem("processor_"+n,a()(r)),e.commit("ADD_PROCESSORS",[r]);var o=JSON.parse(window.localStorage.getItem("processorIds"));return null===o&&(o=[]),o.unshift(n),window.localStorage.setItem("processorIds",a()(o)),r},updateProcessor:function(e,t){var n=JSON.parse(window.localStorage.getItem("processor_"+t._id));y()(t).forEach(function(e){n[e]=t[e]}),window.localStorage.setItem("processor_"+t._id,a()(n)),e.commit("UPDATE_PROCESSOR",t)},deleteProcessor:function(e,t){window.localStorage.removeItem("processor_"+t._id),e.commit("DELETE_PROCESSOR",t);var n=JSON.parse(window.localStorage.getItem("processorIds"));if(null!==n){var r=n.indexOf(t._id);-1!==r&&(n.splice(r,1),window.localStorage.setItem("processorIds",a()(n)))}},authenticateBlocks:function(){var e=Object(A["a"])(regeneratorRuntime.mark(function e(t,n){var r,a,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<n.length)){e.next=11;break}if(!n[r].msal){e.next=8;break}return a="msal|"+n[r].msal.clientId,e.next=6,K(n[r].msal);case 6:o=e.sent,t.commit("ADD_TOKEN",{id:a,token:o});case 8:r++,e.next=1;break;case 11:case"end":return e.stop()}},e)}));function t(t,n){return e.apply(this,arguments)}return t}(),createClient:function(e,t){return new j.a(function(t,n){delete i.a.defaults.headers.common["Authorization"],i.a.post("clients",{role:"online-client",documentName:"Online interface",documentType:"browser",online:!0}).then(function(n){return e.commit("SET_WEB_APP_CLIENT",n.data.resource),t(n.data.resource)}).catch(function(e){return console.warn(e),n(e)}),i.a.defaults.headers.common["Authorization"]=e.state.token})},getUser:function(e,t){return new j.a(function(n,r){var a=e.state.users.find(function(e){return e._id===t._id});if(a)return n(a);i.a.get("accounts/".concat(t._id)).then(function(r){return e.state.user._id===t._id&&(r.data.resource.surname+=" (that is you!)"),e.commit("ADD_USER",r.data.resource),n(r.data.resource)}).catch(function(e){return r(e)})})},getPlugins:function(e,t){i.a.get().then(function(t){var n=t.data.plugins;n.forEach(function(t){e.commit("ADD_PLUGIN",t)})}).catch(function(e){return console.warn(e),reject(e)})},updateLoggedInUser:function(e,t){return new j.a(function(n,r){console.log(t),i.a.put("accounts",t).then(function(r){return e.commit("UPDATE_USER",t),n(r)}).catch(function(e){return r(e)})})},authenticate:function(e,t){return new j.a(function(){var n=Object(A["a"])(regeneratorRuntime.mark(function n(r,a){var o,c,s;return regeneratorRuntime.wrap(function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,i.a.get(new URL("/api/accounts",t.server),{headers:{Authorization:t.token}});case 3:return o=n.sent,console.log(o),e.commit("SET_TOKEN",t.token),e.commit("SET_USER",o.data.resource),e.commit("SET_SERVER",new URL("/api",t.server)),n.next=10,i.a.get("".concat(t.server,"/api"));case 10:return c=n.sent,e.commit("SET_SERVER_DETAILS",c.data),i.a.defaults.headers.common["Authorization"]=t.token,i.a.defaults.baseURL="".concat(t.server,"/api"),localStorage.setItem("currentServer","".concat(t.server,"/api")),localStorage.setItem("token",t.token),s=localStorage.getItem("allSpeckleServers")?new P.a(localStorage.getItem("allSpeckleServers").split(",")):new P.a(["".concat(t.server,"/api")]),s.add("".concat(t.server,"/api")),console.log("".concat(t.server,"/api")),console.log(s),localStorage.setItem("allSpeckleServers",Object(R["a"])(s)),n.abrupt("return",r());case 24:return n.prev=24,n.t0=n["catch"](0),console.log(n.t0),n.abrupt("return",a(n.t0.message));case 28:case"end":return n.stop()}},n,null,[[0,24]])}));return function(e,t){return n.apply(this,arguments)}}())},logout:function(e,t){e.commit("FLUSH_ALL"),localStorage.removeItem("token"),localStorage.removeItem("viewerSettings"),localStorage.removeItem("currentServer"),i.a.defaults.headers.common["Authorization"]="",i.a.defaults.baseURL=""}},modules:{admin:z,viewer:Q}});o["default"].use(k["a"]);var X=new k["a"]({linkExactActiveClass:"is-active",routes:[{path:"/",name:"dashboard",component:function(){return n.e("chunk-bea16dec").then(n.bind(null,"7277"))},meta:{requiresAuth:!0}},{path:"/signin:redirectTo?",name:"signin",component:function(){return n.e("chunk-2d0cb6c3").then(n.bind(null,"4a33"))},beforeEnter:function(e,t,n){n()}},{path:"/signin/callback",name:"signin-cb",component:function(){return n.e("chunk-2d22d1db").then(n.bind(null,"f5b8"))}},{path:"/streams",name:"streams",component:function(){return Promise.all([n.e("chunk-c45573d2"),n.e("chunk-2d0af48a"),n.e("chunk-7abd522e")]).then(n.bind(null,"cf8c"))},meta:{requiresAuth:!0}},{path:"/streams/:streamId",component:function(){return Promise.all([n.e("chunk-c45573d2"),n.e("chunk-2d0af48a"),n.e("chunk-43e930b8")]).then(n.bind(null,"7057"))},meta:{requiresAuth:!0},children:[{name:"stream overview",path:"",component:function(){return Promise.all([n.e("chunk-c45573d2"),n.e("chunk-2d0af48a"),n.e("chunk-080abe1e")]).then(n.bind(null,"a29c"))}},{name:"stream data",path:"data",component:function(){return Promise.all([n.e("chunk-c45573d2"),n.e("chunk-a5f28366")]).then(n.bind(null,"05ce"))}},{name:"stream sharing",path:"sharing",component:function(){return Promise.all([n.e("chunk-c45573d2"),n.e("chunk-f2159fa4")]).then(n.bind(null,"69e0"))}},{name:"stream history",path:"history",component:function(){return Promise.all([n.e("chunk-c45573d2"),n.e("chunk-2d0db2c8"),n.e("chunk-2d0d9f44")]).then(n.bind(null,"6a14"))}}]},{path:"/projects",name:"projects",component:function(){return Promise.all([n.e("chunk-c45573d2"),n.e("chunk-2d0af48a"),n.e("chunk-2d2138f6")]).then(n.bind(null,"acca"))},meta:{requiresAuth:!0}},{path:"/projects/:projectId",name:"project overview",component:function(){return Promise.all([n.e("chunk-c45573d2"),n.e("chunk-2d0af48a"),n.e("chunk-2d0db2c8"),n.e("chunk-298df38e")]).then(n.bind(null,"07bd"))},meta:{requiresAuth:!0}},{path:"/view/:streamIds*",name:"viewer",component:function(){return Promise.all([n.e("chunk-a45fa086"),n.e("chunk-4ab64705")]).then(n.bind(null,"e1b1"))},meta:{requiresAuth:!1}},{path:"/trash",name:"trash",component:function(){return Promise.all([n.e("chunk-c45573d2"),n.e("chunk-2d0af48a"),n.e("chunk-2d0b3630")]).then(n.bind(null,"27c8"))},meta:{requiresAuth:!0}},{path:"/profile",name:"profile",component:function(){return n.e("chunk-2d217357").then(n.bind(null,"c66d"))},meta:{requiresAuth:!0}},{path:"/admin",name:"admin",component:function(){return n.e("chunk-2d0b9d35").then(n.bind(null,"3530"))},meta:{requiresAuth:!0},children:[{name:"admin users",path:"",component:function(){return Promise.all([n.e("chunk-c45573d2"),n.e("chunk-35bc4d64")]).then(n.bind(null,"6135"))}},{name:"admin streams",path:"streams",component:function(){return Promise.all([n.e("chunk-c45573d2"),n.e("chunk-0a9372bf")]).then(n.bind(null,"5c65"))}},{name:"admin projects",path:"projects",component:function(){return Promise.all([n.e("chunk-c45573d2"),n.e("chunk-0083a15b")]).then(n.bind(null,"828b"))}}]},{path:"/processors",name:"processors",component:function(){return Promise.all([n.e("chunk-c45573d2"),n.e("chunk-2d0af48a"),n.e("chunk-2d0abfdc")]).then(n.bind(null,"1843"))},meta:{requiresAuth:!0}},{path:"/processors/:processorId",name:"processor overview",component:function(){return Promise.all([n.e("chunk-2d0af48a"),n.e("chunk-a45fa086"),n.e("chunk-6e6c150c")]).then(n.bind(null,"7179"))},meta:{requiresAuth:!0}},{path:"/pluginsadmin",name:"plugins",component:function(){return n.e("chunk-2d0d7de8").then(n.bind(null,"793c"))},meta:{requiresAuth:!0}}]});X.afterEach(function(e,t){if("signin-cb"!==e.name){var n=e.query.s?JSON.parse(w.a.decode(e.query.s)):{};n&&n.server&&n.server===Z.state.server||(Z.state.server&&(n.server=Z.state.server),X.$Countly&&X.$Countly.q.push(["track_pageview",e.name]),X.replace({params:e.params,query:{s:w()(a()(n))}}))}}),X.beforeEach(function(e,t,n){if(e.meta.requiresAuth&&!0===e.meta.requiresAuth&&!1===Z.state.isAuth)return n({path:"/signin"});n()});var ee=X,te=n("9483");Object(te["a"])("".concat("","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var ne=n("ce5b"),re=n.n(ne),ae=(n("bf40"),n("c0a4")),oe=n.n(ae),ce=n("8682"),ie=n("4710"),se=n.n(ie),ue=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{attrs:{title:e.hint,contenteditable:!e.disabled},domProps:{innerHTML:e._s(e.getContent())},on:{blur:e.updateOnBlur,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateOnEnter(t)}}})},le=[],de={name:"EditableSpan",props:{text:{type:String,default:"loading..."},disabled:{type:Boolean,default:!1},hint:{type:String,default:"click and type to edit"},dataKey:{type:String,default:""}},computed:{},data:function(){return{innerText:null}},methods:{getContent:function(){return this.innerText&&""!==this.innerText.replace(/(\r\n|\n|\r)/gm,"")?this.innerText:this.text},updateOnBlur:function(e){var t=e.target.innerText.replace(/(\r\n|\n|\r)/gm,"");if(""===t)return e.target.innerText=this.text;this.getContent()!==t&&(this.innerText=t,this.$emit("update",{text:t,dataKey:this.dataKey}))},updateOnEnter:function(e){var t=e.target.innerText.replace(/(\r\n|\n|\r)/gm,"");if(""===t)return e.target.innerText=this.text;this.getContent()!==t?(e.target.blur(),this.innerText=t):e.target.blur()}}},fe=de,me=(n("68ac"),Object(h["a"])(fe,ue,le,!1,null,"1f8234a0",null)),he=me.exports,pe=n("e8bd"),ve=n.n(pe),ge=n("2988"),be=n.n(ge);o["default"].config.productionTip=!1,o["default"].use(re.a,{theme:{primary:oe.a.blue.darken1,secondary:oe.a.blue.lighten4,accent:oe.a.indigo.base}}),o["default"].use(ce["a"],{locale:"en"});var _e=localStorage.getItem("currentServer");_e&&(Z.state.server=_e);try{var Ee=window.location.href.split("?")[1],Se=Ee.split("=")[1],we=JSON.parse(w.a.decode(Se));we.server&&Z.state.server!=we.server&&(Z.state.server=we.server)}catch(Ie){console.log("Query borked"),console.log(Ie)}i.a.defaults.baseURL=Z.state.server;var ke=localStorage.getItem("token");i.a.get(Z.state.server).then(function(e){return Z.state.serverManifest=e.data,i.a.get("".concat(Z.state.server,"/accounts?omit=logins"),{headers:{Authorization:ke}})}).then(function(e){null!==e&&200===e.status?(i.a.defaults.headers.common["Authorization"]=ke,Z.state.isAuth=!0,Z.state.user=e.data.resource,Z.state.token=ke,je()):je()}).catch(function(e){je()}),o["default"].prototype.$http=i.a,window.bus=new o["default"];var Ae=new se.a;o["default"].mixin({methods:{getHexFromString:function(e){return Ae.hex(e)},hexFromString:function(e){return Ae.hex(e)},appendInfoToUrl:function(e,t){var n=this.$route.query.s?JSON.parse(w.a.decode(this.$route.query.s)):{};null!==t?n[e]=t:delete n[e],this.$router.replace({params:this.$route.params,query:{s:w()(a()(n))}})},getUrlQueryObject:function(){return this.$route.query.s&&this.$route.query.s?JSON.parse(w.a.decode(this.$route.query.s)):null}}}),o["default"].component("editable-span",he),o["default"].use(be.a,ve.a,{app_key:"04ac5c1e31e993f2624e964475dd949e9a3443f5",url:"https://telemetry.speckle.works"}),o["default"].prototype.$pluginRoutes=[];var Te=n("e331");try{Te.keys().forEach(function(e){var t=Te(e),n=o["default"].component(t.default.name,t.default||t),r=t.default.name.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/\s+/g,"-").toLowerCase(),a={name:r,path:"/plugins/"+r,component:n,meta:{requiresAuth:t.default.manifest.requiresAuth}};ee.addRoutes([a]),o["default"].prototype.$pluginRoutes.push(a),t.default.manifest.registerInNav&&Z.state.adminPlugins.push({name:t.default.manifest.humanReadableName,description:t.default.manifest.description,icon:t.default.manifest.icon,requiresAuth:t.default.manifest.requiresAuth,route:"/plugins/"+r})})}catch(ye){console.error(ye)}var je=function(){new o["default"]({router:ee,store:Z,render:function(e){return e(E)},created:function(){this.$Countly.q.push(["track_sessions"]),ee.$Countly=this.$Countly}}).$mount("#app")}},"5c0b":function(e,t,n){"use strict";var r=n("5e27"),a=n.n(r);a.a},"5e27":function(e,t,n){},"68ac":function(e,t,n){"use strict";var r=n("e997"),a=n.n(r);a.a},e331:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="e331"},e997:function(e,t,n){}});
//# sourceMappingURL=app.36f58e49.js.map