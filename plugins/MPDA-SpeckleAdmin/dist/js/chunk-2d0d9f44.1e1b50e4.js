(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d9f44"],{"6a14":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs12:""}},[n("v-card",{staticClass:"elevation-0"},[t.stream.parent?n("v-toolbar",{staticClass:"elevation-0 transparent"},[n("v-icon",{attrs:{small:"",left:""}},[t._v("home")]),t._v(" \n        "),n("span",{staticClass:"title font-weight-light"},[t._v("\n          Parent stream: "),n("router-link",{attrs:{to:"/streams/"+t.stream.parent}},[t._v(t._s(t.stream.parent))])],1)],1):t._e(),n("v-toolbar",{staticClass:"elevation-0 transparent"},[n("v-icon",{attrs:{small:"",left:""}},[t._v("history")]),t._v(" \n        "),t.stream.children.length>0?n("span",{staticClass:"title font-weight-light"},[t._v("\n          Showing max 30 versions (total: "+t._s(t.streamChildren.length)+" versions).\n        ")]):n("span",{staticClass:"title font-weight-light"},[t._v("\n          This stream has no history.\n        ")])],1),n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs12:"","pa-3":""}},[n("v-timeline",{attrs:{clipped:"",dense:""}},t._l(t.sizeBound,function(e,a){return n("v-timeline-item",{key:e.streamId,attrs:{small:"",color:t.hexFromString(e.streamId)}},[n("div",{class:(0===a?"elevation-5":"elevation-0")+" py-3 px-4"},[n("v-btn",{attrs:{icon:""},nativeOn:{click:function(n){return t.$router.push("/view/"+e.streamId)}}},[n("v-icon",[t._v("360")])],1),0===a?n("span",{class:"headline font-weight-bold "+t.hexFromString(e.streamId)+"--text"},[t._v("\n                  Latest\n                ")]):n("span",{class:"headline "+(0===a?"font-weight-bold":"")+" "+t.hexFromString(e.streamId)+"--text"},[t._v("\n                  "+t._s(t.getDate(e.createdAt))+" "+t._s(t.getTime(e.createdAt))+"\n                ")]),n("timeago",{attrs:{datetime:e.updatedAt}}),n("p",{class:"xxxheadline font-weight-light mb-3 "+t.hexFromString(e.streamId)+"--text"},[n("v-icon",{attrs:{small:""}},[t._v(t._s(e.private?"lock":"lock_open"))]),t._v("  \n                  "),n("v-icon",{attrs:{small:""}},[t._v("fingerprint")]),t._v(" "+t._s(e.streamId)+"\n                  "),n("span",{staticClass:"text-capitalize font-weight-bold"},[t._v(t._s(e.name))])],1),n("div",[n("v-combobox",{attrs:{items:t.allTags,hint:"tags",solo:"","persistent-hint":"","small-chips":"","deletable-chips":"",multiple:"",tags:""},on:{input:function(n){return t.updateTags({tags:e.tags,streamId:e.streamId})}},scopedSlots:t._u([{key:"no-data",fn:function(){return[n("p",[t._v("Add a new tag!")])]},proxy:!0}],null,!0),model:{value:e.tags,callback:function(n){t.$set(e,"tags",n)},expression:"stream.tags"}}),t._v("\n                  "+t._s(e.commitMessage?e.commitMessage:"No commit message.")+"\n                ")],1),n("v-divider",{staticClass:"my-3"}),e.diffResult?n("div",[n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(a){var s=a.on;return[n("span",t._g({staticClass:"green--text"},s),[n("v-icon",{staticClass:"green--text",attrs:{small:""}},[t._v("add_circle_outline")]),n("b",[t._v(" "+t._s(e.diffResult.data.objects.inA.length))])],1),t._v("  \n                    ")]}}],null,!0)},[n("span",[t._v("Added objects")])]),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(a){var s=a.on;return[n("span",t._g({staticClass:"red--text"},s),[n("v-icon",{staticClass:"red--text",attrs:{small:""}},[t._v("remove_circle_outline")]),n("b",[t._v(" "+t._s(e.diffResult.data.objects.inB.length))])],1),t._v("  \n                    ")]}}],null,!0)},[n("span",[t._v("Removed objects")])]),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(a){var s=a.on;return[n("span",t._g({},s),[n("b",[n("span",{staticStyle:{"font-size":"20px"}},[t._v("∩")]),t._v(" "+t._s(e.diffResult.data.objects.common.length))])]),t._v("  \n                    ")]}}],null,!0)},[n("span",[t._v("Common objects")])]),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(a){var s=a.on;return[n("span",t._g({staticClass:"grey--text"},s),[n("b",[t._v("Σ "+t._s(e.diffResult.data.objects.inA.length+e.diffResult.data.objects.common.length))])])]}}],null,!0)},[n("span",[t._v("Total object count")])])],1):t._e()],1)])}),1)],1)],1)],1)],1)],1)},s=[],r=(n("55dd"),n("ac6a"),n("96cf"),n("3b8d")),i=n("795b"),o=n.n(i),l=n("75fc"),c=(n("7514"),n("bc3a")),d=n.n(c),m=n("f7fe"),u=n.n(m),h=(n("13bb"),n("6f79")),f=n.n(h),v={name:"StreamHistory",components:{VueSlider:f.a},watch:{"stream.children":function(){this.fetchData()}},computed:{allTags:function(){return this.$store.getters.allTags},sizeBound:function(){return this.streamChildren.slice(0,30)},stream:function(){var t=this;return this.$store.state.streams.find(function(e){return e.streamId===t.$route.params.streamId})},canEdit:function(){return!!this.isOwner||-1!==this.stream.canWrite.indexOf(this.$store.state.user._id)},isOwner:function(){return this.stream.owner===this.$store.state.user._id}},data:function(){return{parentStream:null,streamChildren:[]}},methods:{getDate:function(t){var e=new Date(t);return e.toLocaleString("en",{year:"numeric",month:"long",day:"numeric"})},getTime:function(t){var e=new Date(t);return e.toLocaleString("en",{timeStyle:"short"})},updateTags:u()(function(t){this.$store.dispatch("updateStream",{streamId:t.streamId,tags:t.tags})},500),sliderChanged:function(t){console.log(t);var e=this.$refs.timeSlider.getIndex();this.lowerIndex=e[0],this.upperIndex=e[1]},fetchData:function(){var t=this;this.stream.children&&0!==this.stream.children.length&&this.stream.children.map(function(t){return d.a.get("streams/".concat(t,"?fields=streamId,updatedAt,createdAt,owner,tags,name,commitMessage,description"))}).reduce(function(t,e){return t.then(function(t){return e.then(function(e){return[].concat(Object(l["a"])(t),[e.data.resource])})})},o.a.resolve([])).then(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(n){var a,s,r,i,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n.forEach(function(t){return t.diffResult={data:{objects:{inA:[],common:[],inB:[]}}}}),t.streamChildren=n,t.streamChildren.push(t.parentStream),t.streamChildren=t.streamChildren.sort(function(t,e){return new Date(e.updatedAt)-new Date(t.updatedAt)}),a="".concat(t.stream.streamId,"\n"),s=0;case 6:if(!(s<t.streamChildren.length-1)){e.next=17;break}return r=t.streamChildren[s],i=t.streamChildren[s+1],e.next=11,d.a.get("streams/".concat(r.streamId,"/diff/").concat(i.streamId));case 11:t.streamChildren[s].diffResult=e.sent,o=t.streamChildren[s].diffResult.data,a+=" \t".concat(o.objects.inA.length,"\t").concat(o.objects.inB.length,"\t").concat(o.objects.common.length,"\t").concat(o.objects.inA.length+o.objects.common.length," \n");case 14:s++,e.next=6;break;case 17:console.log(a);case 18:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}},mounted:function(){var t=this;console.log("hello data"),this.parentStream=this.$store.state.streams.find(function(e){return e.streamId===t.$route.params.streamId}),this.fetchData(this.$route.params.streamId)}},p=v,g=n("2877"),_=Object(g["a"])(p,a,s,!1,null,null,null);e["default"]=_.exports}}]);
//# sourceMappingURL=chunk-2d0d9f44.1e1b50e4.js.map